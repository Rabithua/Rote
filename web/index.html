<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Rote</title>
    <meta name="description" content="Personal note like twitter" />
    <link rel="icon" type="image/svg+xml" href="/ico.svg" />
    <!-- 让页面在移动端使用 viewport 缩放规则 -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <!-- 禁止 Safari 拖动刷新效果（有些页面不希望有 bounce） -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <!-- Import Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600;900&display=swap"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <!-- Import manifest -->
    <link rel="manifest" href="/manifest.json" />
    <!-- Some meta -->
    <link rel="apple-touch-icon" href="/icon@180w.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme:light)" />
    <meta name="theme-color" content="#0a0a0a" media="(prefers-color-scheme:dark)" />

    <script src="https://cdn.jsdelivr.net/npm/ios-pwa-splash@1.0.0/cdn.min.js"></script>
    <script>
      iosPWASplash('logo.png', '#ffffff');
    </script>
    <!-- 运行时配置注入：容器启动脚本会替换此处的占位符 -->
    <!-- 注意：此脚本必须在 React 代码加载前执行，确保配置可用 -->
    <!-- 使用立即执行函数确保同步执行，避免时序问题 -->
    <script>
      (function () {
        // 初始化配置对象（如果不存在）
        if (!window.__ROTE_CONFIG__) {
          window.__ROTE_CONFIG__ = {};
        }
        // 容器启动脚本会替换此占位符为实际的 API 基础 URL
        // 注意：sed 全局替换会替换所有占位符，包括条件判断中的
        // 因此使用 URL 格式检测来判断是否被替换（有效的 API URL 以 http:// 或 https:// 开头）
        var apiBase = '__VITE_API_BASE_PLACEHOLDER__';
        // 检查是否是有效的 URL（以 http:// 或 https:// 开头）
        // 这样可以避免因为全局替换导致条件判断失效的问题
        if (
          apiBase &&
          typeof apiBase === 'string' &&
          (apiBase.indexOf('http://') === 0 || apiBase.indexOf('https://') === 0)
        ) {
          window.__ROTE_CONFIG__.VITE_API_BASE = apiBase;
        }
      })();
    </script>
    <!-- Umami -->
    <script
      defer
      src="https://umami.rote.ink/script.js"
      data-website-id="99c1821a-4d53-47b5-9014-f74bfa60cd0a"
    ></script>
    <!-- React Scan - Development only -->
    <script type="module">
      if (import.meta.env.DEV) {
        const script = document.createElement('script');
        script.src = 'https://unpkg.com/react-scan/dist/auto.global.js';
        document.head.appendChild(script);
      }
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
